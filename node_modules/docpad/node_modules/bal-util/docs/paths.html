<!DOCTYPE html>  <html> <head>   <title>paths.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>            <div id="jump_to">         Jump To &hellip;         <div id="jump_wrapper">           <div id="jump_page">                                           <a class="source" href="balutil.html">                 balutil.coffee               </a>                                           <a class="source" href="compare.html">                 compare.coffee               </a>                                           <a class="source" href="events.html">                 events.coffee               </a>                                           <a class="source" href="groups.html">                 groups.coffee               </a>                                           <a class="source" href="modules.html">                 modules.coffee               </a>                                           <a class="source" href="paths.html">                 paths.coffee               </a>                                           <a class="source" href="types.html">                 types.coffee               </a>                        </div>         </div>       </div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               paths.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>               <p>Requires</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">fs = </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">)</span>
<span class="nv">request = </span><span class="kc">null</span>
<span class="nv">balUtilPaths = </span><span class="kc">null</span>
<span class="nv">balUtilGroups = </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;#{__dirname}/groups.coffee&quot;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>=====================================
Paths</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">balUtilPaths =</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Copy a file
Or rather overwrite a file, regardless of whether or not it was existing before
next(err)</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">cp: </span><span class="nf">(src,dst,next) -&gt;</span>
		<span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span> <span class="nx">src</span><span class="p">,</span> <span class="s1">&#39;binary&#39;</span><span class="p">,</span> <span class="nf">(err,data) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Error</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="k">if</span> <span class="nx">err</span>
				<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;balUtilPaths.cp: cp failed on:&#39;</span><span class="p">,</span><span class="nx">src</span>
				<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Success</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="nx">fs</span><span class="p">.</span><span class="nx">writeFile</span> <span class="nx">dst</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="s1">&#39;binary&#39;</span><span class="p">,</span> <span class="nf">(err) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Forward</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="k">if</span> <span class="nx">err</span>
					<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;balUtilPaths.cp: writeFile failed on:&#39;</span><span class="p">,</span><span class="nx">dst</span>
				<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Chain</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="err">@</span>
	</pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <p>Get the parent path</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">getParentPathSync: </span><span class="nf">(p) -&gt;</span>
		<span class="nv">parentPath = </span><span class="nx">p</span><span class="p">.</span><span class="nx">replace</span> <span class="sr">/[\/\\][^\/\\]+$/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>
		<span class="k">return</span> <span class="nx">parentPath</span>
	</pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Ensure path exists
next(err)</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">ensurePath: </span><span class="nf">(p,next) -&gt;</span>
		<span class="nv">path = </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span>
		<span class="nv">p = </span><span class="nx">p</span><span class="p">.</span><span class="nx">replace</span> <span class="sr">/[\/\\]$/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>
		<span class="nx">path</span><span class="p">.</span><span class="nx">exists</span> <span class="nx">p</span><span class="p">,</span> <span class="nf">(exists) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Error </p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">()</span>  <span class="k">if</span> <span class="nx">exists</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <p>Success</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="nv">parentPath = </span><span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">getParentPathSync</span> <span class="nx">p</span>
			<span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">ensurePath</span> <span class="nx">parentPath</span><span class="p">,</span> <span class="nf">(err) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Error</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="k">if</span> <span class="nx">err</span>
					<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;balUtilPaths.ensurePath: failed to ensure the path:&#39;</span><span class="p">,</span><span class="nx">parentPath</span>
					<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Success</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="nx">fs</span><span class="p">.</span><span class="nx">mkdir</span> <span class="nx">p</span><span class="p">,</span> <span class="mi">0700</span><span class="p">,</span> <span class="nf">(err) -&gt;</span>
					<span class="nx">path</span><span class="p">.</span><span class="nx">exists</span> <span class="nx">p</span><span class="p">,</span> <span class="nf">(exists) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Error</p>             </td>             <td class="code">               <div class="highlight"><pre>						<span class="k">if</span> <span class="o">not</span> <span class="nx">exists</span>
							<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;balUtilPaths.ensurePath: failed to create the directory:&#39;</span><span class="p">,</span><span class="nx">p</span>
							<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span> <span class="s1">&#39;Failed to create the directory &#39;</span><span class="o">+</span><span class="nx">p</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Success</p>             </td>             <td class="code">               <div class="highlight"><pre>						<span class="nx">next</span><span class="o">?</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Chain</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="err">@</span>
	</pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Prefix path</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">prefixPathSync: </span><span class="nf">(path,parentPath) -&gt;</span>
		<span class="nv">path = </span><span class="nx">path</span><span class="p">.</span><span class="nx">replace</span> <span class="sr">/[\/\\]$/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span>
		<span class="k">if</span> <span class="sr">/^([a-zA-Z]\:|\/)/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="o">is</span> <span class="kc">false</span>
			<span class="nv">path = </span><span class="nx">parentPath</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nx">path</span>
		<span class="k">return</span> <span class="nx">path</span>
	</pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Is it a directory?
next(err,isDirectory)</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">isDirectory: </span><span class="nf">(fileFullPath,next) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Stat</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">fs</span><span class="p">.</span><span class="nx">stat</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nf">(err,fileStat) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Error</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="k">if</span> <span class="nx">err</span>
				<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;balUtilPaths.isDirectory: stat failed on:&#39;</span><span class="p">,</span><span class="nx">fileFullPath</span>
				<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <p>Success</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="nx">fileStat</span><span class="p">.</span><span class="nx">isDirectory</span><span class="p">())</span>
		</pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Chain</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="err">@</span>
	
	</pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Generate a slug for a file</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">generateSlugSync: </span><span class="nf">(fileFullPath) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Slugify</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nv">result = </span><span class="nx">fileFullPath</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[^a-zA-Z0-9]/g</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^-/</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/-+/</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Return</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="k">return</span> <span class="nx">result</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>Recursively scan a directory, file, or series of files</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">scan: </span><span class="nf">(files,fileAction,dirAction,next) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Actions</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nv">actions =</span>
			<span class="nv">directory: </span><span class="o">=&gt;</span>
				<span class="nx">@scandir</span><span class="p">(</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Directory</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="nx">files</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>File Action</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="nx">fileAction</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p>Dir Action</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="nx">dirAction</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <p>Complete Action</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="nx">next</span>
				<span class="p">)</span>
			
			<span class="nv">files: </span><span class="o">=&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>Queue</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="nv">tasks = </span><span class="k">new</span> <span class="nx">balUtilGroups</span><span class="p">.</span><span class="nx">Group</span> <span class="nx">next</span>
				<span class="nx">tasks</span><span class="p">.</span><span class="nx">total</span> <span class="o">+=</span> <span class="nx">files</span><span class="p">.</span><span class="nx">length</span>
			</pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Array</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="k">for</span> <span class="nx">file</span> <span class="k">in</span> <span class="nx">files</span>
					<span class="nx">@scan</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nx">fileAction</span><span class="p">,</span> <span class="nx">dirAction</span><span class="p">,</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">completer</span><span class="p">()</span>
				</pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <p>Done</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="k">return</span> <span class="kc">true</span>
		</pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <p>String</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="k">if</span> <span class="k">typeof</span> <span class="nx">files</span><span class="p">.</span><span class="nx">charAt</span> <span class="o">isnt</span> <span class="s1">&#39;undefined&#39;</span>
			<span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">isDirectory</span> <span class="nf">(err,isDirectory) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <p>Error</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="k">if</span> <span class="nx">err</span>
					<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
				</pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p>Directory</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="k">else</span> <span class="k">if</span> <span class="nx">isDirectory</span>
					<span class="nx">actions</span><span class="p">.</span><span class="nx">directory</span><span class="p">()</span>
				</pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <p>File</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="k">else</span>
					<span class="nv">files = </span><span class="p">[</span><span class="nx">file</span><span class="p">]</span>
					<span class="nx">actions</span><span class="p">.</span><span class="nx">files</span><span class="p">()</span>
		</pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p>Array</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="k">else</span> <span class="k">if</span> <span class="nx">files</span> <span class="k">instanceof</span> <span class="nb">Array</span>
			<span class="nx">actions</span><span class="p">.</span><span class="nx">files</span><span class="p">()</span>
		</pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <p>Unsupported</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="k">else</span>
			<span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="k">new</span> <span class="nb">Error</span> <span class="s1">&#39;balUtilPaths.scandir: unsupported files type:&#39;</span><span class="p">,</span> <span class="k">typeof</span> <span class="nx">files</span><span class="p">,</span> <span class="nx">files</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <p>Chain</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="err">@</span>
	</pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <p>Scan a directory into a tree
next(err,tree)</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">scantree: </span><span class="nf">(dirPath,next) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <p>Handle</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">scandir</span><span class="p">(</span>
			<span class="nv">path: </span><span class="nx">dirPath</span>
			<span class="nv">readFiles: </span><span class="kc">true</span>
			<span class="nv">next: </span><span class="nf">(err,list,tree) -&gt;</span>
				<span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">tree</span><span class="p">)</span>
		<span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <p>Chain</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="err">@</span></pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <p>Recursively scan a directory
fileAction(fileFullPath,fileRelativePath,next(err,skip)) or false
dirAction(fileFullPath,fileRelativePath,next(err,skip)) or false
next(err,list,tree)</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">scandir: </span><span class="nf">(args...) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>Prepare</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="k">if</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">is</span> <span class="mi">1</span>
			<span class="p">{</span><span class="nx">path</span><span class="p">,</span><span class="nx">parentPath</span><span class="p">,</span><span class="nx">fileAction</span><span class="p">,</span><span class="nx">dirAction</span><span class="p">,</span><span class="nx">next</span><span class="p">,</span><span class="nx">relativePath</span><span class="p">,</span><span class="nx">readFiles</span><span class="p">}</span> <span class="o">=</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
		<span class="k">else</span> <span class="k">if</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;=</span> <span class="mi">4</span>
			<span class="p">[</span><span class="nx">parentPath</span><span class="p">,</span><span class="nx">fileAction</span><span class="p">,</span><span class="nx">dirAction</span><span class="p">,</span><span class="nx">next</span><span class="p">]</span> <span class="o">=</span> <span class="nx">args</span>
		<span class="k">else</span>
			<span class="nv">err = </span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;balUtilPaths.scandir: unknown arguments&#39;</span><span class="p">)</span>
			<span class="k">if</span> <span class="nx">next</span>
				<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
			<span class="k">else</span>
				<span class="k">throw</span> <span class="nx">err</span>
			
		</pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <p>Prepare defaults</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">readFiles</span> <span class="o">or=</span> <span class="kc">false</span></pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <p>Check needed</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="k">if</span> <span class="o">!</span><span class="nx">parentPath</span> <span class="o">and</span> <span class="nx">path</span>
			<span class="nv">parentPath = </span><span class="nx">path</span>
		<span class="k">if</span> <span class="o">!</span><span class="nx">parentPath</span>
			<span class="nv">err = </span><span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;balUtilPaths.scandir: parentPath is needed&#39;</span><span class="p">)</span>
			<span class="k">if</span> <span class="nx">next</span>
				<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
			<span class="k">else</span>
				<span class="k">throw</span> <span class="nx">err</span></pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <p>Return</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nv">list = </span><span class="p">{}</span>
		<span class="nv">tree = </span><span class="p">{}</span></pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <p>Group</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nv">tasks = </span><span class="k">new</span> <span class="nx">balUtilGroups</span><span class="p">.</span><span class="nx">Group</span> <span class="nf">(err) -&gt;</span>
			<span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">list</span><span class="p">,</span> <span class="nx">tree</span><span class="p">)</span>
		</pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p>Cycle</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">fs</span><span class="p">.</span><span class="nx">readdir</span> <span class="nx">parentPath</span><span class="p">,</span> <span class="nf">(err,files) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <p>Check</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="k">if</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exited</span>
				<span class="k">return</span></pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p>Error</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="k">else</span> <span class="k">if</span> <span class="nx">err</span>
				<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;balUtilPaths.scandir: readdir has failed on:&#39;</span><span class="p">,</span> <span class="nx">parentPath</span>
				<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
			</pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <p>Empty?</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="k">else</span> <span class="k">if</span> <span class="o">!</span><span class="nx">files</span><span class="p">.</span><span class="nx">length</span>
				<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span>
			</pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p>Cycle</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="k">else</span> <span class="nx">files</span><span class="p">.</span><span class="nx">forEach</span> <span class="nf">(file) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>Prepare</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="o">++</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">total</span>
				<span class="nv">fileFullPath = </span><span class="nx">parentPath</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="nx">file</span>
				<span class="nv">fileRelativePath = </span><span class="p">(</span><span class="k">if</span> <span class="nx">relativePath</span> <span class="k">then</span> <span class="nx">relativePath</span><span class="o">+</span><span class="s1">&#39;/&#39;</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="nx">file</span></pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <p>IsDirectory</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">isDirectory</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nf">(err,isDirectory) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <p>Check</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="k">if</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exited</span>
						<span class="k">return</span>
					</pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <p>Error</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="k">else</span> <span class="k">if</span> <span class="nx">err</span>
						<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;balUtilPaths.scandir: isDirectory has failed on:&#39;</span><span class="p">,</span> <span class="nx">fileFullPath</span>
						<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
					</pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <p>Directory</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="k">else</span> <span class="k">if</span> <span class="nx">isDirectory</span></pre></div>             </td>           </tr>                               <tr id="section-61">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-61">&#182;</a>               </div>               <p>Prepare</p>             </td>             <td class="code">               <div class="highlight"><pre>						<span class="nv">complete = </span><span class="nf">(err,skip,subtreeCallback) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-62">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-62">&#182;</a>               </div>               <p>Error</p>             </td>             <td class="code">               <div class="highlight"><pre>							<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span>
				</pre></div>             </td>           </tr>                               <tr id="section-63">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-63">&#182;</a>               </div>               <p>Exited</p>             </td>             <td class="code">               <div class="highlight"><pre>							<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span>  <span class="k">if</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exited</span></pre></div>             </td>           </tr>                               <tr id="section-64">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-64">&#182;</a>               </div>               <p>Handle</p>             </td>             <td class="code">               <div class="highlight"><pre>							<span class="k">if</span> <span class="nx">skip</span> <span class="o">isnt</span> <span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-65">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-65">&#182;</a>               </div>               <p>Append</p>             </td>             <td class="code">               <div class="highlight"><pre>								<span class="nx">list</span><span class="p">[</span><span class="nx">fileRelativePath</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;dir&#39;</span>
								<span class="nx">tree</span><span class="p">[</span><span class="nx">file</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span></pre></div>             </td>           </tr>                               <tr id="section-66">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-66">&#182;</a>               </div>               <p>Recurse</p>             </td>             <td class="code">               <div class="highlight"><pre>								<span class="k">return</span> <span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">scandir</span><span class="p">(</span></pre></div>             </td>           </tr>                               <tr id="section-67">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-67">&#182;</a>               </div>               <p>Path</p>             </td>             <td class="code">               <div class="highlight"><pre>									<span class="nv">path: </span><span class="nx">fileFullPath</span></pre></div>             </td>           </tr>                               <tr id="section-68">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-68">&#182;</a>               </div>               <p>File</p>             </td>             <td class="code">               <div class="highlight"><pre>									<span class="nv">fileAction: </span><span class="nx">fileAction</span></pre></div>             </td>           </tr>                               <tr id="section-69">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-69">&#182;</a>               </div>               <p>Dir</p>             </td>             <td class="code">               <div class="highlight"><pre>									<span class="nv">dirAction: </span><span class="nx">dirAction</span></pre></div>             </td>           </tr>                               <tr id="section-70">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-70">&#182;</a>               </div>               <p>Completed</p>             </td>             <td class="code">               <div class="highlight"><pre>									<span class="nv">next: </span><span class="nf">(err,_list,_tree) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-71">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-71">&#182;</a>               </div>               <p>Merge in children of the parent directory</p>             </td>             <td class="code">               <div class="highlight"><pre>										<span class="nx">tree</span><span class="p">[</span><span class="nx">file</span><span class="p">]</span> <span class="o">=</span> <span class="nx">_tree</span>
										<span class="k">for</span> <span class="nx">own</span> <span class="nx">filePath</span><span class="p">,</span> <span class="nx">fileType</span> <span class="k">of</span> <span class="nx">_list</span>
											<span class="nx">list</span><span class="p">[</span><span class="nx">filePath</span><span class="p">]</span> <span class="o">=</span> <span class="nx">fileType</span></pre></div>             </td>           </tr>                               <tr id="section-72">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-72">&#182;</a>               </div>               <p>Exited</p>             </td>             <td class="code">               <div class="highlight"><pre>										<span class="k">if</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exited</span>
											<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-73">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-73">&#182;</a>               </div>               <p>Error</p>             </td>             <td class="code">               <div class="highlight"><pre>										<span class="k">else</span> <span class="k">if</span> <span class="nx">err</span>
											<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;balUtilPaths.scandir: has failed on:&#39;</span><span class="p">,</span> <span class="nx">fileFullPath</span>
											<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-74">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-74">&#182;</a>               </div>               <p>Subtree</p>             </td>             <td class="code">               <div class="highlight"><pre>										<span class="k">else</span> <span class="k">if</span> <span class="nx">subtreeCallback</span>
											<span class="k">return</span> <span class="nx">subtreeCallback</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">completer</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-75">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-75">&#182;</a>               </div>               <p>Complete</p>             </td>             <td class="code">               <div class="highlight"><pre>										<span class="k">else</span>
											<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">complete</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-76">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-76">&#182;</a>               </div>               <p>Relative Path</p>             </td>             <td class="code">               <div class="highlight"><pre>									<span class="nv">relativePath: </span><span class="nx">fileRelativePath</span></pre></div>             </td>           </tr>                               <tr id="section-77">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-77">&#182;</a>               </div>               <p>Read Files</p>             </td>             <td class="code">               <div class="highlight"><pre>									<span class="nv">readFiles: </span><span class="nx">readFiles</span>
								<span class="p">)</span>
							
							<span class="k">else</span></pre></div>             </td>           </tr>                               <tr id="section-78">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-78">&#182;</a>               </div>               <p>Done</p>             </td>             <td class="code">               <div class="highlight"><pre>								<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">complete</span><span class="p">()</span>
						</pre></div>             </td>           </tr>                               <tr id="section-79">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-79">&#182;</a>               </div>               <p>Action</p>             </td>             <td class="code">               <div class="highlight"><pre>						<span class="k">if</span> <span class="nx">dirAction</span>
							<span class="k">return</span> <span class="nx">dirAction</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nx">fileRelativePath</span><span class="p">,</span> <span class="nx">complete</span>
						<span class="k">else</span> <span class="k">if</span> <span class="nx">dirAction</span> <span class="o">is</span> <span class="kc">false</span>
							<span class="k">return</span> <span class="nx">complete</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="kc">true</span><span class="p">)</span>
						<span class="k">else</span>
							<span class="k">return</span> <span class="nx">complete</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="kc">false</span><span class="p">)</span>
					</pre></div>             </td>           </tr>                               <tr id="section-80">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-80">&#182;</a>               </div>               <p>File</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="k">else</span></pre></div>             </td>           </tr>                               <tr id="section-81">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-81">&#182;</a>               </div>               <p>Prepare</p>             </td>             <td class="code">               <div class="highlight"><pre>						<span class="nv">complete = </span><span class="nf">(err,skip) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-82">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-82">&#182;</a>               </div>               <p>Error</p>             </td>             <td class="code">               <div class="highlight"><pre>							<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span>
							</pre></div>             </td>           </tr>                               <tr id="section-83">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-83">&#182;</a>               </div>               <p>Exited</p>             </td>             <td class="code">               <div class="highlight"><pre>							<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span>  <span class="k">if</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exited</span></pre></div>             </td>           </tr>                               <tr id="section-84">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-84">&#182;</a>               </div>               <p>Handle</p>             </td>             <td class="code">               <div class="highlight"><pre>							<span class="k">if</span> <span class="nx">skip</span></pre></div>             </td>           </tr>                               <tr id="section-85">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-85">&#182;</a>               </div>               <p>Done</p>             </td>             <td class="code">               <div class="highlight"><pre>								<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">complete</span><span class="p">()</span>
							<span class="k">else</span></pre></div>             </td>           </tr>                               <tr id="section-86">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-86">&#182;</a>               </div>               <p>Append</p>             </td>             <td class="code">               <div class="highlight"><pre>								<span class="nx">list</span><span class="p">[</span><span class="nx">fileRelativePath</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;file&#39;</span>
								<span class="k">if</span> <span class="nx">readFiles</span>
									<span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nf">(err,data) -&gt;</span>
										<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span></pre></div>             </td>           </tr>                               <tr id="section-87">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-87">&#182;</a>               </div>               <p>Append</p>             </td>             <td class="code">               <div class="highlight"><pre>										<span class="nx">tree</span><span class="p">[</span><span class="nx">file</span><span class="p">]</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-88">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-88">&#182;</a>               </div>               <p>Done</p>             </td>             <td class="code">               <div class="highlight"><pre>										<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">complete</span><span class="p">()</span>
								<span class="k">else</span></pre></div>             </td>           </tr>                               <tr id="section-89">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-89">&#182;</a>               </div>               <p>Append</p>             </td>             <td class="code">               <div class="highlight"><pre>									<span class="nx">tree</span><span class="p">[</span><span class="nx">file</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span></pre></div>             </td>           </tr>                               <tr id="section-90">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-90">&#182;</a>               </div>               <p>Done</p>             </td>             <td class="code">               <div class="highlight"><pre>									<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">complete</span><span class="p">()</span>
						</pre></div>             </td>           </tr>                               <tr id="section-91">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-91">&#182;</a>               </div>               <p>Action</p>             </td>             <td class="code">               <div class="highlight"><pre>						<span class="k">if</span> <span class="nx">fileAction</span>
							<span class="k">return</span> <span class="nx">fileAction</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nx">fileRelativePath</span><span class="p">,</span> <span class="nx">complete</span>
						<span class="k">else</span> <span class="k">if</span> <span class="nx">fileAction</span> <span class="o">is</span> <span class="kc">false</span>
							<span class="k">return</span> <span class="nx">complete</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="kc">true</span><span class="p">)</span>
						<span class="k">else</span>
							<span class="k">return</span> <span class="nx">complete</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="kc">false</span><span class="p">)</span>
		</pre></div>             </td>           </tr>                               <tr id="section-92">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-92">&#182;</a>               </div>               <p>Chain</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="err">@</span>
	</pre></div>             </td>           </tr>                               <tr id="section-93">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-93">&#182;</a>               </div>               <p>Copy a directory
next(err)</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">cpdir: </span><span class="nf">(srcPath,outPath,next) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-94">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-94">&#182;</a>               </div>               <p>Scan all the files in the diretory and copy them over asynchronously</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">scandir</span><span class="p">(</span></pre></div>             </td>           </tr>                               <tr id="section-95">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-95">&#182;</a>               </div>               <p>Path</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="nx">srcPath</span></pre></div>             </td>           </tr>                               <tr id="section-96">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-96">&#182;</a>               </div>               <p>File</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="nf">(fileSrcPath,fileRelativePath,next) -&gt;</span>
				<span class="nv">fileOutPath = </span><span class="s2">&quot;#{outPath}/#{fileRelativePath}&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-97">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-97">&#182;</a>               </div>               <p>Ensure the directory that the file is going to exists</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">ensurePath</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">).</span><span class="nx">dirname</span><span class="p">(</span><span class="nx">fileOutPath</span><span class="p">),</span> <span class="nf">(err) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-98">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-98">&#182;</a>               </div>               <p>Error</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="k">if</span> <span class="nx">err</span>
						<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;balUtilPaths.cpdir: failed to create the path for the file:&#39;</span><span class="p">,</span><span class="nx">fileSrcPath</span>
						<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-99">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-99">&#182;</a>               </div>               <p>The directory now does exist
So let's now place the file inside it</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">cp</span> <span class="nx">fileSrcPath</span><span class="p">,</span> <span class="nx">fileOutPath</span><span class="p">,</span> <span class="nf">(err) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-100">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-100">&#182;</a>               </div>               <p>Forward</p>             </td>             <td class="code">               <div class="highlight"><pre>						<span class="k">if</span> <span class="nx">err</span>
							<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;balUtilPaths.cpdir: failed to copy the child file:&#39;</span><span class="p">,</span><span class="nx">fileSrcPath</span>
						<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-101">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-101">&#182;</a>               </div>               <p>Dir</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="kc">null</span></pre></div>             </td>           </tr>                               <tr id="section-102">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-102">&#182;</a>               </div>               <p>Completed</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="nx">next</span>
		<span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-103">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-103">&#182;</a>               </div>               <p>Chain</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="err">@</span>
	</pre></div>             </td>           </tr>                               <tr id="section-104">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-104">&#182;</a>               </div>               <p>Remove a directory
next(err)</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">rmdir: </span><span class="nf">(parentPath,next) -&gt;</span>
		<span class="nv">path = </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;path&#39;</span><span class="p">)</span>
		<span class="nx">path</span><span class="p">.</span><span class="nx">exists</span> <span class="nx">parentPath</span><span class="p">,</span> <span class="nf">(exists) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-105">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-105">&#182;</a>               </div>               <p>Skip</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">()</span>  <span class="nx">unless</span> <span class="nx">exists</span></pre></div>             </td>           </tr>                               <tr id="section-106">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-106">&#182;</a>               </div>               <p>Remove</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">scandir</span><span class="p">(</span></pre></div>             </td>           </tr>                               <tr id="section-107">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-107">&#182;</a>               </div>               <p>Path</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="nx">parentPath</span>
				</pre></div>             </td>           </tr>                               <tr id="section-108">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-108">&#182;</a>               </div>               <p>File</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="nf">(fileFullPath,fileRelativePath,next) -&gt;</span>
					<span class="nx">fs</span><span class="p">.</span><span class="nx">unlink</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nf">(err) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-109">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-109">&#182;</a>               </div>               <p>Forward</p>             </td>             <td class="code">               <div class="highlight"><pre>						<span class="k">if</span> <span class="nx">err</span>
							<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;balUtilPaths.rmdir: failed to remove the child file:&#39;</span><span class="p">,</span> <span class="nx">fileFullPath</span>
						<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
				</pre></div>             </td>           </tr>                               <tr id="section-110">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-110">&#182;</a>               </div>               <p>Dir</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="nf">(fileFullPath,fileRelativePath,next) -&gt;</span>
					<span class="nx">next</span><span class="o">?</span> <span class="kc">null</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="nf">(next) -&gt;</span>
						<span class="nx">fs</span><span class="p">.</span><span class="nx">rmdir</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nf">(err) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-111">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-111">&#182;</a>               </div>               <p>Forward</p>             </td>             <td class="code">               <div class="highlight"><pre>							<span class="k">if</span> <span class="nx">err</span>
								<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;balUtilPaths.rmdir: failed to remove the child directory:&#39;</span><span class="p">,</span> <span class="nx">fileFullPath</span>
							<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
				</pre></div>             </td>           </tr>                               <tr id="section-112">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-112">&#182;</a>               </div>               <p>Completed</p>             </td>             <td class="code">               <div class="highlight"><pre>				<span class="nf">(err,list,tree) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-113">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-113">&#182;</a>               </div>               <p>Error</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="k">if</span> <span class="nx">err</span>
						<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">list</span><span class="p">,</span> <span class="nx">tree</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-114">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-114">&#182;</a>               </div>               <p>Success</p>             </td>             <td class="code">               <div class="highlight"><pre>					<span class="nx">fs</span><span class="p">.</span><span class="nx">rmdir</span> <span class="nx">parentPath</span><span class="p">,</span> <span class="nf">(err) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-115">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-115">&#182;</a>               </div>               <p>Forward</p>             </td>             <td class="code">               <div class="highlight"><pre>						<span class="k">if</span> <span class="nx">err</span>
							<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;balUtilPaths.rmdir: failed to remove the parent directory:&#39;</span><span class="p">,</span> <span class="nx">parentPath</span>
						<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">list</span><span class="p">,</span> <span class="nx">tree</span><span class="p">)</span>
			<span class="p">)</span>
		</pre></div>             </td>           </tr>                               <tr id="section-116">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-116">&#182;</a>               </div>               <p>Chain</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="err">@</span></pre></div>             </td>           </tr>                               <tr id="section-117">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-117">&#182;</a>               </div>               <p>Write tree
next(err)</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">writetree: </span><span class="nf">(dstPath,tree,next) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-118">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-118">&#182;</a>               </div>               <p>Group</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nv">tasks = </span><span class="k">new</span> <span class="nx">balUtilGroups</span><span class="p">.</span><span class="nx">Group</span> <span class="nf">(err) -&gt;</span>
			<span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>
		</pre></div>             </td>           </tr>                               <tr id="section-119">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-119">&#182;</a>               </div>               <p>Ensure Destination</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">ensurePath</span> <span class="nx">dstPath</span><span class="p">,</span> <span class="nf">(err) -&gt;</span></pre></div>             </td>           </tr>                               <tr id="section-120">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-120">&#182;</a>               </div>               <p>Checks</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="k">if</span> <span class="nx">err</span>
				<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span> <span class="nx">err</span>
			</pre></div>             </td>           </tr>                               <tr id="section-121">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-121">&#182;</a>               </div>               <p>Cycle</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="k">for</span> <span class="nx">own</span> <span class="nx">fileRelativePath</span><span class="p">,</span> <span class="nx">value</span> <span class="k">of</span> <span class="nx">tree</span>
				<span class="o">++</span><span class="nx">tasks</span><span class="p">.</span><span class="nx">total</span>
				<span class="nv">fileFullPath = </span><span class="nx">dstPath</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="nx">fileRelativePath</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^\/+/</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
				<span class="k">if</span> <span class="k">typeof</span> <span class="nx">value</span> <span class="o">is</span> <span class="s1">&#39;object&#39;</span>
					<span class="nx">balUtilPaths</span><span class="p">.</span><span class="nx">writetree</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">completer</span><span class="p">()</span>
				<span class="k">else</span>
					<span class="nx">fs</span><span class="p">.</span><span class="nx">writeFile</span> <span class="nx">fileFullPath</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nf">(err) -&gt;</span>
						<span class="k">if</span> <span class="nx">err</span>
							<span class="nx">console</span><span class="p">.</span><span class="nx">log</span> <span class="s1">&#39;balUtilPaths.writetree: writeFile failed on:&#39;</span><span class="p">,</span><span class="nx">fileFullPath</span>
						<span class="k">return</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">complete</span> <span class="nx">err</span>
			</pre></div>             </td>           </tr>                               <tr id="section-122">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-122">&#182;</a>               </div>               <p>Empty?</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="k">if</span> <span class="nx">tasks</span><span class="p">.</span><span class="nx">total</span> <span class="o">is</span> <span class="mi">0</span>
				<span class="nx">tasks</span><span class="p">.</span><span class="nx">exit</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-123">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-123">&#182;</a>               </div>               <p>Return</p>             </td>             <td class="code">               <div class="highlight"><pre>			<span class="k">return</span>
		</pre></div>             </td>           </tr>                               <tr id="section-124">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-124">&#182;</a>               </div>               <p>Chain</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="err">@</span></pre></div>             </td>           </tr>                               <tr id="section-125">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-125">&#182;</a>               </div>               <p>Read path
Reads a path be it local or remote
next(err,data)</p>             </td>             <td class="code">               <div class="highlight"><pre>	<span class="nv">readPath: </span><span class="nf">(filePath,next) -&gt;</span>
		<span class="k">if</span> <span class="sr">/^http/</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">filePath</span><span class="p">)</span>
			<span class="nv">request = </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;request&#39;</span><span class="p">)</span>  <span class="nx">unless</span> <span class="nx">request</span>
			<span class="nx">request</span> <span class="nx">filePath</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span><span class="nx">response</span><span class="p">,</span><span class="nx">data</span><span class="p">)</span> <span class="o">=&gt;</span>
				<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span>
				<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="nx">data</span><span class="p">)</span>
		<span class="k">else</span>
			<span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span> <span class="nx">filePath</span><span class="p">,</span> <span class="nf">(err,data) -&gt;</span>
				<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span>  <span class="k">if</span> <span class="nx">err</span>
				<span class="k">return</span> <span class="nx">next</span><span class="o">?</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="nx">data</span><span class="p">)</span>
		</pre></div>             </td>           </tr>                               <tr id="section-126">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-126">&#182;</a>               </div>               <p>Chain</p>             </td>             <td class="code">               <div class="highlight"><pre>		<span class="err">@</span></pre></div>             </td>           </tr>                               <tr id="section-127">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-127">&#182;</a>               </div>               <p>=====================================
Export</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">module.exports = </span><span class="nx">balUtilPaths</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 